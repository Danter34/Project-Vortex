2025-10-18 22:09:04.948 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[Amount], [p].[CreatedAt], [p].[MomoOrderId], [p].[OrderId], [p].[PayUrl], [p].[PaymentMethod], [p].[Status], [o].[Id], [o].[CreatedAt], [o].[Name], [o].[Phone], [o].[ShippingAddress], [o].[Status], [o].[TotalAmount], [o].[UserId]
FROM [Payments] AS [p]
INNER JOIN [Orders] AS [o] ON [p].[OrderId] = [o].[Id]
WHERE [p].[Status] IN (N'Đang xử lý', N'Thanh toán thất bại')
2025-10-18 22:09:08.453 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7161/api/Review/add-review - application/json; charset=utf-8 105
2025-10-18 22:09:08.455 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ReviewController.AddReview (Vortex_API)'
2025-10-18 22:09:08.459 +07:00 [INF] Route matched with {action = "AddReview", controller = "Review"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddReview(Vortex_API.Model.DTO.ReviewDTO) on controller Vortex_API.Controllers.ReviewController (Vortex_API).
2025-10-18 22:09:08.471 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__dto_ProductId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Orders] AS [o]
        WHERE [o].[UserId] = @__userId_0 AND [o].[Status] = N'Đã giao hàng' AND EXISTS (
            SELECT 1
            FROM [OrderItems] AS [o0]
            WHERE [o].[Id] = [o0].[OrderId] AND [o0].[ProductId] = @__dto_ProductId_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-18 22:09:08.484 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Reviews] ([Comment], [CreatedAt], [ProductId], [Rating], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-18 22:09:08.495 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AverageRating], [t].[CategoryId], [t].[CreatedAt], [t].[Description], [t].[IsHot], [t].[IsNew], [t].[Price], [t].[StockQuantity], [t].[Title], [r].[Id], [r].[Comment], [r].[CreatedAt], [r].[ProductId], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(1) [p].[Id], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title]
    FROM [Products] AS [p]
    WHERE [p].[Id] = @__dto_ProductId_0
) AS [t]
LEFT JOIN [Reviews] AS [r] ON [t].[Id] = [r].[ProductId]
ORDER BY [t].[Id]
2025-10-18 22:09:08.506 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [AverageRating] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-10-18 22:09:08.508 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Review'.
2025-10-18 22:09:08.509 +07:00 [INF] Executed action Vortex_API.Controllers.ReviewController.AddReview (Vortex_API) in 49.3732ms
2025-10-18 22:09:08.510 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ReviewController.AddReview (Vortex_API)'
2025-10-18 22:09:08.511 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7161/api/Review/add-review - 200 null application/json; charset=utf-8 58.039ms
2025-10-18 22:09:08.528 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - null null
2025-10-18 22:09:08.529 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:08.530 +07:00 [INF] Route matched with {action = "GetById", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Vortex_API.Controllers.ProductController (Vortex_API).
2025-10-18 22:09:08.531 +07:00 [INF] Fetching product by ID: 10
2025-10-18 22:09:08.542 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AverageRating], [t].[CategoryId], [t].[CreatedAt], [t].[Description], [t].[IsHot], [t].[IsNew], [t].[Price], [t].[StockQuantity], [t].[Title], [t].[Id0], [t].[Name], [t].[ParentId], [i].[Id], [i].[FileDescription], [i].[FileExtension], [i].[FileName], [i].[FilePath], [i].[FileSizeInBytes], [i].[ProductId]
FROM (
    SELECT TOP(1) [p].[Id], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title], [c].[Id] AS [Id0], [c].[Name], [c].[ParentId]
    FROM [Products] AS [p]
    INNER JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[Id]
    WHERE [p].[Id] = @__id_0
) AS [t]
LEFT JOIN [Images] AS [i] ON [t].[Id] = [i].[ProductId]
ORDER BY [t].[Id], [t].[Id0]
2025-10-18 22:09:08.544 +07:00 [INF] Product with ID 10 retrieved successfully.
2025-10-18 22:09:08.545 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Product'.
2025-10-18 22:09:08.545 +07:00 [INF] Executed action Vortex_API.Controllers.ProductController.GetById (Vortex_API) in 14.3045ms
2025-10-18 22:09:08.546 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:08.547 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - 200 null application/json; charset=utf-8 19.5731ms
2025-10-18 22:09:08.552 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - null null
2025-10-18 22:09:08.554 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:08.555 +07:00 [INF] Route matched with {action = "GetReviews", controller = "Review"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetReviews(Int32) on controller Vortex_API.Controllers.ReviewController (Vortex_API).
2025-10-18 22:09:08.567 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ProductId], [r].[Rating], [r].[Comment], [a].[FullName]
FROM [Reviews] AS [r]
INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
WHERE [r].[ProductId] = @__productId_0
ORDER BY [r].[CreatedAt] DESC
2025-10-18 22:09:08.569 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Vortex_API.Model.DTO.ReviewDTO, Vortex_API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 22:09:08.569 +07:00 [INF] Executed action Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API) in 12.9663ms
2025-10-18 22:09:08.570 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:08.571 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - 200 null application/json; charset=utf-8 18.5629ms
2025-10-18 22:09:08.577 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - null null
2025-10-18 22:09:08.579 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:08.580 +07:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCart() on controller Vortex_API.Controllers.CartController (Vortex_API).
2025-10-18 22:09:08.591 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[UserId], [t0].[Id], [t0].[CartId], [t0].[ProductId], [t0].[Quantity], [t0].[Id0], [t0].[AverageRating], [t0].[CategoryId], [t0].[CreatedAt], [t0].[Description], [t0].[IsHot], [t0].[IsNew], [t0].[Price], [t0].[StockQuantity], [t0].[Title]
FROM (
    SELECT TOP(1) [c].[Id], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_0
) AS [t]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[ProductId], [c0].[Quantity], [p].[Id] AS [Id0], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title]
    FROM [CartItems] AS [c0]
    INNER JOIN [Products] AS [p] ON [c0].[ProductId] = [p].[Id]
) AS [t0] ON [t].[Id] = [t0].[CartId]
ORDER BY [t].[Id], [t0].[Id]
2025-10-18 22:09:08.593 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Cart'.
2025-10-18 22:09:08.594 +07:00 [INF] Executed action Vortex_API.Controllers.CartController.GetCart (Vortex_API) in 13.3776ms
2025-10-18 22:09:08.595 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:08.596 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - 200 null application/json; charset=utf-8 18.9714ms
2025-10-18 22:09:22.415 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7161/api/Review/add-review - application/json; charset=utf-8 52
2025-10-18 22:09:22.418 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ReviewController.AddReview (Vortex_API)'
2025-10-18 22:09:22.418 +07:00 [INF] Route matched with {action = "AddReview", controller = "Review"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddReview(Vortex_API.Model.DTO.ReviewDTO) on controller Vortex_API.Controllers.ReviewController (Vortex_API).
2025-10-18 22:09:22.430 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__dto_ProductId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Orders] AS [o]
        WHERE [o].[UserId] = @__userId_0 AND [o].[Status] = N'Đã giao hàng' AND EXISTS (
            SELECT 1
            FROM [OrderItems] AS [o0]
            WHERE [o].[Id] = [o0].[OrderId] AND [o0].[ProductId] = @__dto_ProductId_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-18 22:09:22.443 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Reviews] ([Comment], [CreatedAt], [ProductId], [Rating], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-18 22:09:22.455 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AverageRating], [t].[CategoryId], [t].[CreatedAt], [t].[Description], [t].[IsHot], [t].[IsNew], [t].[Price], [t].[StockQuantity], [t].[Title], [r].[Id], [r].[Comment], [r].[CreatedAt], [r].[ProductId], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(1) [p].[Id], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title]
    FROM [Products] AS [p]
    WHERE [p].[Id] = @__dto_ProductId_0
) AS [t]
LEFT JOIN [Reviews] AS [r] ON [t].[Id] = [r].[ProductId]
ORDER BY [t].[Id]
2025-10-18 22:09:22.467 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [AverageRating] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-10-18 22:09:22.469 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Review'.
2025-10-18 22:09:22.470 +07:00 [INF] Executed action Vortex_API.Controllers.ReviewController.AddReview (Vortex_API) in 50.3104ms
2025-10-18 22:09:22.471 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ReviewController.AddReview (Vortex_API)'
2025-10-18 22:09:22.472 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7161/api/Review/add-review - 200 null application/json; charset=utf-8 56.6841ms
2025-10-18 22:09:22.482 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - null null
2025-10-18 22:09:22.484 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:22.485 +07:00 [INF] Route matched with {action = "GetById", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Vortex_API.Controllers.ProductController (Vortex_API).
2025-10-18 22:09:22.487 +07:00 [INF] Fetching product by ID: 10
2025-10-18 22:09:22.499 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AverageRating], [t].[CategoryId], [t].[CreatedAt], [t].[Description], [t].[IsHot], [t].[IsNew], [t].[Price], [t].[StockQuantity], [t].[Title], [t].[Id0], [t].[Name], [t].[ParentId], [i].[Id], [i].[FileDescription], [i].[FileExtension], [i].[FileName], [i].[FilePath], [i].[FileSizeInBytes], [i].[ProductId]
FROM (
    SELECT TOP(1) [p].[Id], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title], [c].[Id] AS [Id0], [c].[Name], [c].[ParentId]
    FROM [Products] AS [p]
    INNER JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[Id]
    WHERE [p].[Id] = @__id_0
) AS [t]
LEFT JOIN [Images] AS [i] ON [t].[Id] = [i].[ProductId]
ORDER BY [t].[Id], [t].[Id0]
2025-10-18 22:09:22.502 +07:00 [INF] Product with ID 10 retrieved successfully.
2025-10-18 22:09:22.502 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Product'.
2025-10-18 22:09:22.503 +07:00 [INF] Executed action Vortex_API.Controllers.ProductController.GetById (Vortex_API) in 16.8871ms
2025-10-18 22:09:22.504 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:22.505 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - 200 null application/json; charset=utf-8 23.0272ms
2025-10-18 22:09:22.511 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - null null
2025-10-18 22:09:22.513 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:22.514 +07:00 [INF] Route matched with {action = "GetReviews", controller = "Review"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetReviews(Int32) on controller Vortex_API.Controllers.ReviewController (Vortex_API).
2025-10-18 22:09:22.526 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ProductId], [r].[Rating], [r].[Comment], [a].[FullName]
FROM [Reviews] AS [r]
INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
WHERE [r].[ProductId] = @__productId_0
ORDER BY [r].[CreatedAt] DESC
2025-10-18 22:09:22.528 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Vortex_API.Model.DTO.ReviewDTO, Vortex_API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 22:09:22.529 +07:00 [INF] Executed action Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API) in 13.4887ms
2025-10-18 22:09:22.530 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:22.530 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - 200 null application/json; charset=utf-8 19.1594ms
2025-10-18 22:09:22.536 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - null null
2025-10-18 22:09:22.539 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:22.539 +07:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCart() on controller Vortex_API.Controllers.CartController (Vortex_API).
2025-10-18 22:09:22.551 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[UserId], [t0].[Id], [t0].[CartId], [t0].[ProductId], [t0].[Quantity], [t0].[Id0], [t0].[AverageRating], [t0].[CategoryId], [t0].[CreatedAt], [t0].[Description], [t0].[IsHot], [t0].[IsNew], [t0].[Price], [t0].[StockQuantity], [t0].[Title]
FROM (
    SELECT TOP(1) [c].[Id], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_0
) AS [t]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[ProductId], [c0].[Quantity], [p].[Id] AS [Id0], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title]
    FROM [CartItems] AS [c0]
    INNER JOIN [Products] AS [p] ON [c0].[ProductId] = [p].[Id]
) AS [t0] ON [t].[Id] = [t0].[CartId]
ORDER BY [t].[Id], [t0].[Id]
2025-10-18 22:09:22.553 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Cart'.
2025-10-18 22:09:22.554 +07:00 [INF] Executed action Vortex_API.Controllers.CartController.GetCart (Vortex_API) in 13.1073ms
2025-10-18 22:09:22.555 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:22.556 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - 200 null application/json; charset=utf-8 19.2725ms
2025-10-18 22:09:29.803 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7161/api/Review/add-review - application/json; charset=utf-8 47
2025-10-18 22:09:29.806 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ReviewController.AddReview (Vortex_API)'
2025-10-18 22:09:29.806 +07:00 [INF] Route matched with {action = "AddReview", controller = "Review"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddReview(Vortex_API.Model.DTO.ReviewDTO) on controller Vortex_API.Controllers.ReviewController (Vortex_API).
2025-10-18 22:09:29.819 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__dto_ProductId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Orders] AS [o]
        WHERE [o].[UserId] = @__userId_0 AND [o].[Status] = N'Đã giao hàng' AND EXISTS (
            SELECT 1
            FROM [OrderItems] AS [o0]
            WHERE [o].[Id] = [o0].[OrderId] AND [o0].[ProductId] = @__dto_ProductId_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-18 22:09:29.832 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Reviews] ([Comment], [CreatedAt], [ProductId], [Rating], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-18 22:09:29.843 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__dto_ProductId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AverageRating], [t].[CategoryId], [t].[CreatedAt], [t].[Description], [t].[IsHot], [t].[IsNew], [t].[Price], [t].[StockQuantity], [t].[Title], [r].[Id], [r].[Comment], [r].[CreatedAt], [r].[ProductId], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(1) [p].[Id], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title]
    FROM [Products] AS [p]
    WHERE [p].[Id] = @__dto_ProductId_0
) AS [t]
LEFT JOIN [Reviews] AS [r] ON [t].[Id] = [r].[ProductId]
ORDER BY [t].[Id]
2025-10-18 22:09:29.855 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Double)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Products] SET [AverageRating] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-10-18 22:09:29.857 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Review'.
2025-10-18 22:09:29.858 +07:00 [INF] Executed action Vortex_API.Controllers.ReviewController.AddReview (Vortex_API) in 50.1181ms
2025-10-18 22:09:29.859 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ReviewController.AddReview (Vortex_API)'
2025-10-18 22:09:29.859 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7161/api/Review/add-review - 200 null application/json; charset=utf-8 56.3335ms
2025-10-18 22:09:29.870 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - null null
2025-10-18 22:09:29.872 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:29.873 +07:00 [INF] Route matched with {action = "GetById", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Vortex_API.Controllers.ProductController (Vortex_API).
2025-10-18 22:09:29.874 +07:00 [INF] Fetching product by ID: 10
2025-10-18 22:09:29.885 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AverageRating], [t].[CategoryId], [t].[CreatedAt], [t].[Description], [t].[IsHot], [t].[IsNew], [t].[Price], [t].[StockQuantity], [t].[Title], [t].[Id0], [t].[Name], [t].[ParentId], [i].[Id], [i].[FileDescription], [i].[FileExtension], [i].[FileName], [i].[FilePath], [i].[FileSizeInBytes], [i].[ProductId]
FROM (
    SELECT TOP(1) [p].[Id], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title], [c].[Id] AS [Id0], [c].[Name], [c].[ParentId]
    FROM [Products] AS [p]
    INNER JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[Id]
    WHERE [p].[Id] = @__id_0
) AS [t]
LEFT JOIN [Images] AS [i] ON [t].[Id] = [i].[ProductId]
ORDER BY [t].[Id], [t].[Id0]
2025-10-18 22:09:29.888 +07:00 [INF] Product with ID 10 retrieved successfully.
2025-10-18 22:09:29.888 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Product'.
2025-10-18 22:09:29.889 +07:00 [INF] Executed action Vortex_API.Controllers.ProductController.GetById (Vortex_API) in 15.0451ms
2025-10-18 22:09:29.890 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:29.891 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - 200 null application/json; charset=utf-8 20.6173ms
2025-10-18 22:09:29.896 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - null null
2025-10-18 22:09:29.898 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:29.899 +07:00 [INF] Route matched with {action = "GetReviews", controller = "Review"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetReviews(Int32) on controller Vortex_API.Controllers.ReviewController (Vortex_API).
2025-10-18 22:09:29.910 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ProductId], [r].[Rating], [r].[Comment], [a].[FullName]
FROM [Reviews] AS [r]
INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
WHERE [r].[ProductId] = @__productId_0
ORDER BY [r].[CreatedAt] DESC
2025-10-18 22:09:29.912 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Vortex_API.Model.DTO.ReviewDTO, Vortex_API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 22:09:29.912 +07:00 [INF] Executed action Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API) in 12.8634ms
2025-10-18 22:09:29.913 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:29.914 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - 200 null application/json; charset=utf-8 17.8016ms
2025-10-18 22:09:29.920 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - null null
2025-10-18 22:09:29.923 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:29.924 +07:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCart() on controller Vortex_API.Controllers.CartController (Vortex_API).
2025-10-18 22:09:29.934 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[UserId], [t0].[Id], [t0].[CartId], [t0].[ProductId], [t0].[Quantity], [t0].[Id0], [t0].[AverageRating], [t0].[CategoryId], [t0].[CreatedAt], [t0].[Description], [t0].[IsHot], [t0].[IsNew], [t0].[Price], [t0].[StockQuantity], [t0].[Title]
FROM (
    SELECT TOP(1) [c].[Id], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_0
) AS [t]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[ProductId], [c0].[Quantity], [p].[Id] AS [Id0], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title]
    FROM [CartItems] AS [c0]
    INNER JOIN [Products] AS [p] ON [c0].[ProductId] = [p].[Id]
) AS [t0] ON [t].[Id] = [t0].[CartId]
ORDER BY [t].[Id], [t0].[Id]
2025-10-18 22:09:29.937 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Cart'.
2025-10-18 22:09:29.938 +07:00 [INF] Executed action Vortex_API.Controllers.CartController.GetCart (Vortex_API) in 12.923ms
2025-10-18 22:09:29.939 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:29.939 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - 200 null application/json; charset=utf-8 19.0311ms
2025-10-18 22:09:35.581 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - null null
2025-10-18 22:09:35.583 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:35.584 +07:00 [INF] Route matched with {action = "GetById", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Vortex_API.Controllers.ProductController (Vortex_API).
2025-10-18 22:09:35.585 +07:00 [INF] Fetching product by ID: 10
2025-10-18 22:09:35.596 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[AverageRating], [t].[CategoryId], [t].[CreatedAt], [t].[Description], [t].[IsHot], [t].[IsNew], [t].[Price], [t].[StockQuantity], [t].[Title], [t].[Id0], [t].[Name], [t].[ParentId], [i].[Id], [i].[FileDescription], [i].[FileExtension], [i].[FileName], [i].[FilePath], [i].[FileSizeInBytes], [i].[ProductId]
FROM (
    SELECT TOP(1) [p].[Id], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title], [c].[Id] AS [Id0], [c].[Name], [c].[ParentId]
    FROM [Products] AS [p]
    INNER JOIN [Categories] AS [c] ON [p].[CategoryId] = [c].[Id]
    WHERE [p].[Id] = @__id_0
) AS [t]
LEFT JOIN [Images] AS [i] ON [t].[Id] = [i].[ProductId]
ORDER BY [t].[Id], [t].[Id0]
2025-10-18 22:09:35.598 +07:00 [INF] Product with ID 10 retrieved successfully.
2025-10-18 22:09:35.599 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Product'.
2025-10-18 22:09:35.600 +07:00 [INF] Executed action Vortex_API.Controllers.ProductController.GetById (Vortex_API) in 14.9799ms
2025-10-18 22:09:35.601 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ProductController.GetById (Vortex_API)'
2025-10-18 22:09:35.602 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Product/get-product-by-id/10 - 200 null application/json; charset=utf-8 20.5565ms
2025-10-18 22:09:35.607 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - null null
2025-10-18 22:09:35.608 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:35.609 +07:00 [INF] Route matched with {action = "GetReviews", controller = "Review"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetReviews(Int32) on controller Vortex_API.Controllers.ReviewController (Vortex_API).
2025-10-18 22:09:35.620 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[ProductId], [r].[Rating], [r].[Comment], [a].[FullName]
FROM [Reviews] AS [r]
INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
WHERE [r].[ProductId] = @__productId_0
ORDER BY [r].[CreatedAt] DESC
2025-10-18 22:09:35.622 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Vortex_API.Model.DTO.ReviewDTO, Vortex_API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 22:09:35.623 +07:00 [INF] Executed action Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API) in 12.775ms
2025-10-18 22:09:35.624 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.ReviewController.GetReviews (Vortex_API)'
2025-10-18 22:09:35.625 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Review/get-review/10 - 200 null application/json; charset=utf-8 17.8296ms
2025-10-18 22:09:35.630 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - null null
2025-10-18 22:09:35.633 +07:00 [INF] Executing endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:35.633 +07:00 [INF] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCart() on controller Vortex_API.Controllers.CartController (Vortex_API).
2025-10-18 22:09:35.644 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[UserId], [t0].[Id], [t0].[CartId], [t0].[ProductId], [t0].[Quantity], [t0].[Id0], [t0].[AverageRating], [t0].[CategoryId], [t0].[CreatedAt], [t0].[Description], [t0].[IsHot], [t0].[IsNew], [t0].[Price], [t0].[StockQuantity], [t0].[Title]
FROM (
    SELECT TOP(1) [c].[Id], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_0
) AS [t]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[ProductId], [c0].[Quantity], [p].[Id] AS [Id0], [p].[AverageRating], [p].[CategoryId], [p].[CreatedAt], [p].[Description], [p].[IsHot], [p].[IsNew], [p].[Price], [p].[StockQuantity], [p].[Title]
    FROM [CartItems] AS [c0]
    INNER JOIN [Products] AS [p] ON [c0].[ProductId] = [p].[Id]
) AS [t0] ON [t].[Id] = [t0].[CartId]
ORDER BY [t].[Id], [t0].[Id]
2025-10-18 22:09:35.646 +07:00 [INF] Executing OkObjectResult, writing value of type 'Vortex_API.Model.Domain.Cart'.
2025-10-18 22:09:35.647 +07:00 [INF] Executed action Vortex_API.Controllers.CartController.GetCart (Vortex_API) in 12.491ms
2025-10-18 22:09:35.648 +07:00 [INF] Executed endpoint 'Vortex_API.Controllers.CartController.GetCart (Vortex_API)'
2025-10-18 22:09:35.649 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7161/api/Cart/get-cart - 200 null application/json; charset=utf-8 18.4494ms
